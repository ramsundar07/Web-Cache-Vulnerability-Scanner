import webbrowser
import requests
from Decorator import prStyle
from suggestor import suggestor

def openre(u):
    reg="sastra.edu"
    u=u+"2"
    h1="X-Forwarded-Scheme"
    h2="X-Forwarded-Host"
    r=requests.get(u,headers={"X-Forwarded-Scheme":"http","X-Forwarded-Host":"sastra.edu"},allow_redirects=False)    
    if(r.status_code==302):
           if (r.headers["Location"]).find(reg) != -1:
                prStyle("Unkeyed-Headers : "+h1)
                prStyle("Unkeyed-Headers : "+h2)
                prStyle("Vulnerable to open redirect","white on red")
                prStyle(u,"blue")
                webbrowser.open(u)  
                u=u+"2"
                r1=requests.get(u,headers={"X-Forwarded-Scheme":"http","X-Forwarded-Host":"example.com:1234"},allow_redirects=False)
                print("------------------------------------------------------------------------")
                if(r1.headers["Location"]).find(":")!=-1:
                    prStyle("Vulnerable to Denial Of Service","white on red")
                    prStyle(u,"blue")
                    webbrowser.open(u)
                suggestor(h1,"",h2)
                             
    else:
        prStyle("Not Vulnerable to Open Redirect and Denial Of Service\n","black on green")


def crossite(h,s,u):
    for i in s:
	    if i.find("example")!= -1:
		    if i.find(".js")!= -1 :
                      print("Vulnerable to Cross site Scripting ")
                      print("Cache Poisoning Affects Javascript File "+h)
    
    
    
